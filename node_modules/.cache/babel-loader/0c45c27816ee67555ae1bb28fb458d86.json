{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\nexports.setMFACode = setMFACode;\nexports.getMFACodeValidation = getMFACodeValidation;\nvar _index = require('./index');\nvar _email = require('./email');\nvar _database = require('../connection/database');\nvar _trim = require('trim');\nvar _trim2 = _interopRequireDefault(_trim);\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar DEFAULT_VALIDATION = {\n  mfa_code: {\n    length: 6\n  }\n};\nvar regExp = /^[0-9]+$/;\nfunction validateMFACode(str) {\n  var settings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_VALIDATION.mfa_code;\n  var value = (0, _trim2.default)(str);\n\n  // check min value matched\n  if (value.length < settings.length) {\n    return false;\n  }\n\n  // check max value matched\n  if (value.length > settings.length) {\n    return false;\n  }\n\n  // check allowed characters matched\n  var result = regExp.exec(value);\n  return result && result[0];\n}\nfunction setMFACode(m, str) {\n  return (0, _index.setField)(m, 'mfa_code', str, validateMFACode);\n}\nfunction getMFACodeValidation(m) {\n  return DEFAULT_VALIDATION.mfa_code;\n}","map":null,"metadata":{},"sourceType":"script"}