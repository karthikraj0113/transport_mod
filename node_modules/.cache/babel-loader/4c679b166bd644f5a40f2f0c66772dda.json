{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSnapshotByObject = getSnapshotByObject;\nexports.firestoreRef = firestoreRef;\nexports.getQueryName = getQueryName;\nexports.getBaseQueryName = getBaseQueryName;\nexports.listenerExists = listenerExists;\nexports.attachListener = attachListener;\nexports.detachListener = detachListener;\nexports.queryStrToObj = queryStrToObj;\nexports.getQueryConfig = getQueryConfig;\nexports.getQueryConfigs = getQueryConfigs;\nexports.orderedFromSnap = orderedFromSnap;\nexports.dataByIdSnapshot = dataByIdSnapshot;\nexports.getPopulateChild = getPopulateChild;\nexports.populateList = populateList;\nexports.promisesForPopulate = promisesForPopulate;\nexports.dispatchListenerResponse = dispatchListenerResponse;\nexports.getPopulateActions = getPopulateActions;\nexports.snapshotCache = void 0;\nvar _cloneDeep2 = _interopRequireDefault(require(\"lodash/cloneDeep\"));\nvar _set2 = _interopRequireDefault(require(\"lodash/set\"));\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\nvar _map2 = _interopRequireDefault(require(\"lodash/map\"));\nvar _has2 = _interopRequireDefault(require(\"lodash/has\"));\nvar _forEach2 = _interopRequireDefault(require(\"lodash/forEach\"));\nvar _trim2 = _interopRequireDefault(require(\"lodash/trim\"));\nvar _isEmpty2 = _interopRequireDefault(require(\"lodash/isEmpty\"));\nvar _isNumber2 = _interopRequireDefault(require(\"lodash/isNumber\"));\nvar _isObject2 = _interopRequireDefault(require(\"lodash/isObject\"));\nvar _constants = require(\"../constants\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _toArray(arr) {\n  return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n}\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n    return arr2;\n  }\n}\nvar snapshotCache = new WeakMap();\nexports.snapshotCache = snapshotCache;\nfunction getSnapshotByObject(obj) {\n  return snapshotCache.get(obj);\n}\nfunction addWhereToRef(ref, where) {\n  if (!Array.isArray(where)) {\n    throw new Error('where parameter must be an array.');\n  }\n  if (Array.isArray(where[0])) {\n    return where.reduce(function (acc, whereArgs) {\n      return addWhereToRef(acc, whereArgs);\n    }, ref);\n  }\n  return ref.where.apply(ref, _toConsumableArray(where));\n}\nfunction addOrderByToRef(ref, orderBy) {\n  if (!Array.isArray(orderBy) && !(typeof orderBy === 'string' || orderBy instanceof String)) {\n    throw new Error('orderBy parameter must be an array or string.');\n  }\n  if (typeof orderBy === 'string' || orderBy instanceof String) {\n    return ref.orderBy(orderBy);\n  }\n  if (typeof orderBy[0] === 'string' || orderBy[0] instanceof String) {\n    return ref.orderBy.apply(ref, _toConsumableArray(orderBy));\n  }\n  return orderBy.reduce(function (acc, orderByArgs) {\n    return addOrderByToRef(acc, orderByArgs);\n  }, ref);\n}\nfunction arrayify(cursor) {\n  return [].concat(cursor);\n}\nfunction handleSubcollections(ref, subcollectionList) {\n  if (Array.isArray(subcollectionList)) {\n    subcollectionList.forEach(function (subcollection) {\n      if (subcollection.collection) {\n        if (typeof ref.collection !== 'function') {\n          throw new Error(\"Collection can only be run on a document. Check that query config for subcollection: \\\"\".concat(subcollection.collection, \"\\\" contains a doc parameter.\"));\n        }\n        ref = ref.collection(subcollection.collection);\n      }\n      if (subcollection.doc) ref = ref.doc(subcollection.doc);\n      if (subcollection.where) ref = addWhereToRef(ref, subcollection.where);\n      if (subcollection.orderBy) {\n        ref = addOrderByToRef(ref, subcollection.orderBy);\n      }\n      if (subcollection.limit) ref = ref.limit(subcollection.limit);\n      if (subcollection.startAt) {\n        var _ref;\n        ref = (_ref = ref).startAt.apply(_ref, _toConsumableArray(arrayify(subcollection.startAt)));\n      }\n      if (subcollection.startAfter) {\n        var _ref2;\n        ref = (_ref2 = ref).startAfter.apply(_ref2, _toConsumableArray(arrayify(subcollection.startAfter)));\n      }\n      if (subcollection.endAt) {\n        var _ref3;\n        ref = (_ref3 = ref).endAt.apply(_ref3, _toConsumableArray(arrayify(subcollection.endAt)));\n      }\n      if (subcollection.endBefore) {\n        var _ref4;\n        ref = (_ref4 = ref).endBefore.apply(_ref4, _toConsumableArray(arrayify(subcollection.endBefore)));\n      }\n      ref = handleSubcollections(ref, subcollection.subcollections);\n    });\n  }\n  return ref;\n}\nfunction firestoreRef(firebase, meta) {\n  var _ref5, _ref6, _ref7, _ref8;\n  if (!firebase.firestore) {\n    throw new Error('Firestore must be required and initalized.');\n  }\n  var collection = meta.collection,\n    collectionGroup = meta.collectionGroup,\n    doc = meta.doc,\n    subcollections = meta.subcollections,\n    where = meta.where,\n    orderBy = meta.orderBy,\n    limit = meta.limit,\n    startAt = meta.startAt,\n    startAfter = meta.startAfter,\n    endAt = meta.endAt,\n    endBefore = meta.endBefore;\n  var ref = firebase.firestore();\n  if (collection && collectionGroup) {\n    throw new Error('Reference cannot contain both Collection and CollectionGroup.');\n  }\n  if (collection) ref = ref.collection(collection);\n  if (collectionGroup) ref = ref.collectionGroup(collectionGroup);\n  if (doc) ref = ref.doc(doc);\n  ref = handleSubcollections(ref, subcollections);\n  if (where) ref = addWhereToRef(ref, where);\n  if (orderBy) ref = addOrderByToRef(ref, orderBy);\n  if (limit) ref = ref.limit(limit);\n  if (startAt) ref = (_ref5 = ref).startAt.apply(_ref5, _toConsumableArray(arrayify(startAt)));\n  if (startAfter) ref = (_ref6 = ref).startAfter.apply(_ref6, _toConsumableArray(arrayify(startAfter)));\n  if (endAt) ref = (_ref7 = ref).endAt.apply(_ref7, _toConsumableArray(arrayify(endAt)));\n  if (endBefore) ref = (_ref8 = ref).endBefore.apply(_ref8, _toConsumableArray(arrayify(endBefore)));\n  return ref;\n}\nfunction arrayToStr(key, value) {\n  if (typeof value === 'string' || value instanceof String || (0, _isNumber2.default)(value)) {\n    return \"\".concat(key, \"=\").concat(value);\n  }\n  if (typeof value[0] === 'string' || value[0] instanceof String) {\n    return \"\".concat(key, \"=\").concat(value.join(':'));\n  }\n  if (value && typeof value.toString === 'function') {\n    return \"\".concat(key, \"=\").concat(value.toString());\n  }\n  return value.map(function (val) {\n    return arrayToStr(key, val);\n  });\n}\nfunction pickQueryParams(obj) {\n  return ['where', 'orderBy', 'limit', 'startAfter', 'startAt', 'endAt', 'endBefore'].reduce(function (acc, key) {\n    return obj[key] ? _objectSpread({}, acc, _defineProperty({}, key, obj[key])) : acc;\n  }, {});\n}\nfunction serialize(queryParams) {\n  return Object.keys(queryParams).filter(function (key) {\n    return queryParams[key] !== undefined;\n  }).map(function (key) {\n    return arrayToStr(key, queryParams[key]);\n  }).join('&');\n}\nfunction getQueryName(meta) {\n  if (typeof meta === 'string' || meta instanceof String) {\n    return meta;\n  }\n  var collection = meta.collection,\n    collectionGroup = meta.collectionGroup,\n    doc = meta.doc,\n    subcollections = meta.subcollections,\n    storeAs = meta.storeAs,\n    remainingMeta = _objectWithoutProperties(meta, [\"collection\", \"collectionGroup\", \"doc\", \"subcollections\", \"storeAs\"]);\n  if (!collection && !collectionGroup) {\n    throw new Error('Collection or Collection Group is required to build query name');\n  }\n  if (storeAs) {\n    return storeAs;\n  }\n  var basePath = collection || collectionGroup;\n  if (doc) {\n    basePath = basePath.concat(\"/\".concat(doc));\n  }\n  if (collection && subcollections) {\n    console.error('Queries with subcollections must use \"storeAs\" to prevent invalid store updates. This closley matches the upcoming major release (v1), which stores subcollections at the top level by default.');\n    var mappedCollections = subcollections.map(function (subcollection) {\n      return getQueryName(subcollection);\n    });\n    basePath = \"\".concat(basePath, \"/\").concat(mappedCollections.join('/'));\n  }\n  var queryParams = pickQueryParams(remainingMeta);\n  if (!(0, _isEmpty2.default)(queryParams)) {\n    if (queryParams.where && !Array.isArray(queryParams.where)) {\n      throw new Error('where parameter must be an array.');\n    }\n    basePath = basePath.concat('?', serialize(queryParams));\n  }\n  return basePath;\n}\nfunction getBaseQueryName(meta) {\n  if (typeof meta === 'string' || meta instanceof String) {\n    return meta;\n  }\n  var collection = meta.collection,\n    collectionGroup = meta.collectionGroup,\n    subcollections = meta.subcollections,\n    remainingMeta = _objectWithoutProperties(meta, [\"collection\", \"collectionGroup\", \"subcollections\"]);\n  if (!collection && !collectionGroup) {\n    throw new Error('Collection or Collection Group is required to build query name');\n  }\n  var basePath = collection || collectionGroup;\n  if (collection && subcollections) {\n    var mappedCollections = subcollections.map(function (subcollection) {\n      return getQueryName(subcollection);\n    });\n    basePath = \"\".concat(basePath, \"/\").concat(mappedCollections.join('/'));\n  }\n  var queryParams = pickQueryParams(remainingMeta);\n  if (!(0, _isEmpty2.default)(queryParams)) {\n    if (queryParams.where && !Array.isArray(queryParams.where)) {\n      throw new Error('where parameter must be an array.');\n    }\n    basePath = basePath.concat('?', serialize(queryParams));\n  }\n  return basePath;\n}\nfunction confirmMetaAndConfig(firebase, meta) {\n  if (!meta) {\n    throw new Error('Meta data is required to attach listener.');\n  }\n  if (!firebase || !firebase._ || !firebase._.listeners) {\n    throw new Error('Internal Firebase object required to attach listener. Confirm that reduxFirestore enhancer was added when you were creating your store');\n  }\n}\nfunction listenerExists(firebase, meta) {\n  confirmMetaAndConfig(firebase, meta);\n  var name = getQueryName(meta);\n  return !!firebase._.listeners[name];\n}\nfunction attachListener(firebase, dispatch, meta, unsubscribe) {\n  confirmMetaAndConfig(firebase, meta);\n  var name = getQueryName(meta);\n  if (!firebase._.listeners[name]) {\n    firebase._.listeners[name] = unsubscribe;\n  }\n  dispatch({\n    type: _constants.actionTypes.SET_LISTENER,\n    meta: meta,\n    payload: {\n      name: name\n    }\n  });\n  return firebase._.listeners;\n}\nfunction detachListener(firebase, dispatch, meta) {\n  var name = getQueryName(meta);\n  if (firebase._.listeners[name]) {\n    firebase._.listeners[name]();\n    delete firebase._.listeners[name];\n  }\n  dispatch({\n    type: _constants.actionTypes.UNSET_LISTENER,\n    meta: meta,\n    payload: {\n      name: name\n    }\n  });\n}\nfunction queryStrToObj(queryPathStr, parsedPath) {\n  var pathArr = parsedPath || (0, _trim2.default)(queryPathStr, ['/']).split('/');\n  var _pathArr = _toArray(pathArr),\n    collection = _pathArr[0],\n    doc = _pathArr[1],\n    subcollections = _pathArr.slice(2);\n  var queryObj = {};\n  if (collection) queryObj.collection = collection;\n  if (doc) queryObj.doc = doc;\n  if (subcollections.length) {\n    queryObj.subcollections = [queryStrToObj('', subcollections)];\n  }\n  return queryObj;\n}\nfunction getQueryConfig(query) {\n  if (typeof query === 'string' || query instanceof String) {\n    return queryStrToObj(query);\n  }\n  if ((0, _isObject2.default)(query)) {\n    if (!query.collection && !query.collectionGroup && !query.doc) {\n      throw new Error('Collection, Collection Group and/or Doc are required parameters within query definition object.');\n    }\n    return query;\n  }\n  throw new Error('Invalid Path Definition: Only Strings and Objects are accepted.');\n}\nfunction getQueryConfigs(queries) {\n  if (Array.isArray(queries)) {\n    return queries.map(getQueryConfig);\n  }\n  if (typeof queries === 'string' || queries instanceof String) {\n    return queryStrToObj(queries);\n  }\n  if ((0, _isObject2.default)(queries)) {\n    return [getQueryConfig(queries)];\n  }\n  throw new Error('Querie(s) must be an Array or a string.');\n}\nfunction orderedFromSnap(snap) {\n  var ordered = [];\n  if (snap.data && snap.exists) {\n    var obj = (0, _isObject2.default)(snap.data()) ? _objectSpread({\n      id: snap.id\n    }, snap.data() || snap.data) : {\n      id: snap.id,\n      data: snap.data()\n    };\n    snapshotCache.set(obj, snap);\n    ordered.push(obj);\n  } else if (snap.forEach) {\n    snap.forEach(function (doc) {\n      var obj = (0, _isObject2.default)(doc.data()) ? _objectSpread({\n        id: doc.id\n      }, doc.data() || doc.data) : {\n        id: doc.id,\n        data: doc.data()\n      };\n      snapshotCache.set(obj, doc);\n      ordered.push(obj);\n    });\n  }\n  snapshotCache.set(ordered, snap);\n  return ordered;\n}\nfunction dataByIdSnapshot(snap) {\n  var data = {};\n  if (snap.data) {\n    var snapData = snap.exists ? snap.data() : null;\n    if (snapData) {\n      snapshotCache.set(snapData, snap);\n    }\n    data[snap.id] = snapData;\n  } else if (snap.forEach) {\n    snap.forEach(function (doc) {\n      var snapData = doc.data() || doc;\n      snapshotCache.set(snapData, doc);\n      data[doc.id] = snapData;\n    });\n  }\n  if (!!data && Object.keys(data).length) {\n    snapshotCache.set(data, snap);\n    return data;\n  }\n  return null;\n}\nfunction getPopulateChild(firebase, populate, id) {\n  return firestoreRef(firebase, {\n    collection: populate.root,\n    doc: id\n  }).get().then(function (snap) {\n    return _objectSpread({\n      id: id\n    }, snap.data());\n  });\n}\nfunction populateList(firebase, originalObj, p, results) {\n  if (!results[p.root]) {\n    (0, _set2.default)(results, p.root, {});\n  }\n  return Promise.all((0, _map2.default)(originalObj, function (id, childKey) {\n    var populateKey = id === true || p.populateByKey ? childKey : id;\n    return getPopulateChild(firebase, p, populateKey).then(function (pc) {\n      if (pc) {\n        return (0, _set2.default)(results, \"\".concat(p.root, \".\").concat(populateKey), pc);\n      }\n      return results;\n    });\n  }));\n}\nfunction getPopulateObj(str) {\n  if (typeof str === 'string' || str instanceof String) {\n    return str;\n  }\n  var strArray = str.split(':');\n  return {\n    child: strArray[0],\n    root: strArray[1]\n  };\n}\nfunction getPopulateObjs(arr) {\n  if (!Array.isArray(arr)) {\n    return arr;\n  }\n  return arr.map(function (o) {\n    return (0, _isObject2.default)(o) ? o : getPopulateObj(o);\n  });\n}\nfunction promisesForPopulate(firebase, dataKey, originalData, populatesIn) {\n  var promisesArray = [];\n  var results = {};\n  var populatesForData = getPopulateObjs(typeof populatesIn === 'function' ? populatesIn(dataKey, originalData) : populatesIn);\n  var dataHasPopulateChilds = populatesForData.some(function (populate) {\n    return (0, _has2.default)(originalData, populate.child);\n  });\n  if (dataHasPopulateChilds) {\n    populatesForData.forEach(function (p) {\n      var childDataVal = (0, _get2.default)(originalData, p.child);\n      if (typeof childDataVal === 'string' || childDataVal instanceof String) {\n        return promisesArray.push(getPopulateChild(firebase, p, childDataVal).then(function (v) {\n          if (v) {\n            (0, _set2.default)(results, \"\".concat(p.storeAs ? p.storeAs : p.root, \".\").concat(childDataVal), v);\n          }\n        }));\n      }\n      return promisesArray.push(populateList(firebase, childDataVal, p, results));\n    });\n  } else {\n    (0, _forEach2.default)(originalData, function (d, key) {\n      var populatesForDataItem = getPopulateObjs(typeof populatesIn === 'function' ? populatesIn(key, d) : populatesIn);\n      (0, _forEach2.default)(populatesForDataItem, function (p) {\n        var idOrList = (0, _get2.default)(d, p.child);\n        if (!idOrList) {\n          return;\n        }\n        if (typeof idOrList === 'string' || idOrList instanceof String) {\n          return promisesArray.push(getPopulateChild(firebase, p, idOrList).then(function (v) {\n            if (v) {\n              (0, _set2.default)(results, \"\".concat(p.storeAs ? p.storeAs : p.root, \".\").concat(idOrList), v);\n            }\n            return results;\n          }));\n        }\n        if (Array.isArray(idOrList) || (0, _isObject2.default)(idOrList)) {\n          return promisesArray.push(populateList(firebase, idOrList, p, results));\n        }\n      });\n    });\n  }\n  return Promise.all(promisesArray).then(function () {\n    return results;\n  });\n}\nvar changeTypeToEventType = {\n  added: _constants.actionTypes.DOCUMENT_ADDED,\n  removed: _constants.actionTypes.DOCUMENT_REMOVED,\n  modified: _constants.actionTypes.DOCUMENT_MODIFIED\n};\nfunction docChangeEvent(change) {\n  var originalMeta = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var meta = _objectSpread({}, (0, _cloneDeep2.default)(originalMeta), {\n    path: change.doc.ref.path\n  });\n  if (originalMeta.subcollections && !originalMeta.storeAs) {\n    meta.subcollections[0] = _objectSpread({}, meta.subcollections[0], {\n      doc: change.doc.id\n    });\n  } else {\n    meta.doc = change.doc.id;\n  }\n  return {\n    type: changeTypeToEventType[change.type] || _constants.actionTypes.DOCUMENT_MODIFIED,\n    meta: meta,\n    payload: {\n      data: change.doc.data(),\n      ordered: {\n        oldIndex: change.oldIndex,\n        newIndex: change.newIndex\n      }\n    }\n  };\n}\nfunction dispatchListenerResponse(_ref9) {\n  var dispatch = _ref9.dispatch,\n    docData = _ref9.docData,\n    meta = _ref9.meta,\n    firebase = _ref9.firebase;\n  var _ref10 = firebase._.config || {},\n    mergeOrdered = _ref10.mergeOrdered,\n    mergeOrderedDocUpdates = _ref10.mergeOrderedDocUpdates,\n    mergeOrderedCollectionUpdates = _ref10.mergeOrderedCollectionUpdates;\n  var docChanges = typeof docData.docChanges === 'function' ? docData.docChanges() : docData.docChanges;\n  if (docChanges && docChanges.length < docData.size) {\n    docChanges.forEach(function (change) {\n      dispatch(docChangeEvent(change, meta));\n    });\n  } else {\n    dispatch({\n      type: _constants.actionTypes.LISTENER_RESPONSE,\n      meta: meta,\n      payload: {\n        data: dataByIdSnapshot(docData),\n        ordered: orderedFromSnap(docData)\n      },\n      merge: {\n        docs: mergeOrdered && mergeOrderedDocUpdates,\n        collections: mergeOrdered && mergeOrderedCollectionUpdates\n      }\n    });\n  }\n}\nfunction getPopulateActions(_ref11) {\n  var firebase = _ref11.firebase,\n    docData = _ref11.docData,\n    meta = _ref11.meta;\n  return promisesForPopulate(firebase, docData.id, dataByIdSnapshot(docData), meta.populates).then(function (populateResults) {\n    return Object.keys(populateResults).map(function (resultKey) {\n      return {\n        meta: {\n          collection: resultKey\n        },\n        payload: {\n          data: populateResults[resultKey]\n        },\n        requesting: false,\n        requested: true\n      };\n    });\n  }).catch(function (populateErr) {\n    console.error('Error with populate:', populateErr, meta);\n    return Promise.reject(populateErr);\n  });\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","getSnapshotByObject","firestoreRef","getQueryName","getBaseQueryName","listenerExists","attachListener","detachListener","queryStrToObj","getQueryConfig","getQueryConfigs","orderedFromSnap","dataByIdSnapshot","getPopulateChild","populateList","promisesForPopulate","dispatchListenerResponse","getPopulateActions","snapshotCache","_cloneDeep2","_interopRequireDefault","require","_set2","_get2","_map2","_has2","_forEach2","_trim2","_isEmpty2","_isNumber2","_isObject2","_constants","obj","__esModule","default","_toArray","arr","_arrayWithHoles","_iterableToArray","_nonIterableRest","TypeError","Array","isArray","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","key","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","prototype","propertyIsEnumerable","call","sourceKeys","keys","ownKeys","object","enumerableOnly","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","iter","Symbol","iterator","toString","from","arr2","WeakMap","get","addWhereToRef","ref","where","Error","reduce","acc","whereArgs","addOrderByToRef","orderBy","String","orderByArgs","arrayify","cursor","concat","handleSubcollections","subcollectionList","subcollection","collection","doc","limit","startAt","_ref","startAfter","_ref2","endAt","_ref3","endBefore","_ref4","subcollections","firebase","meta","_ref5","_ref6","_ref7","_ref8","firestore","collectionGroup","arrayToStr","join","map","val","pickQueryParams","serialize","queryParams","undefined","storeAs","remainingMeta","basePath","console","error","mappedCollections","confirmMetaAndConfig","_","listeners","name","dispatch","unsubscribe","type","actionTypes","SET_LISTENER","payload","UNSET_LISTENER","queryPathStr","parsedPath","pathArr","split","_pathArr","slice","queryObj","query","queries","snap","ordered","data","exists","id","set","snapData","populate","root","then","originalObj","p","results","Promise","all","childKey","populateKey","populateByKey","pc","getPopulateObj","str","strArray","child","getPopulateObjs","o","dataKey","originalData","populatesIn","promisesArray","populatesForData","dataHasPopulateChilds","some","childDataVal","v","d","populatesForDataItem","idOrList","changeTypeToEventType","added","DOCUMENT_ADDED","removed","DOCUMENT_REMOVED","modified","DOCUMENT_MODIFIED","docChangeEvent","change","originalMeta","path","oldIndex","newIndex","_ref9","docData","_ref10","config","mergeOrdered","mergeOrderedDocUpdates","mergeOrderedCollectionUpdates","docChanges","size","LISTENER_RESPONSE","merge","docs","collections","_ref11","populates","populateResults","resultKey","requesting","requested","catch","populateErr","reject"],"sources":["C:/Users/diskk/OneDrive/Desktop/New folder/Transport_modal/node_modules/redux-firestore/es/utils/query.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getSnapshotByObject = getSnapshotByObject;\nexports.firestoreRef = firestoreRef;\nexports.getQueryName = getQueryName;\nexports.getBaseQueryName = getBaseQueryName;\nexports.listenerExists = listenerExists;\nexports.attachListener = attachListener;\nexports.detachListener = detachListener;\nexports.queryStrToObj = queryStrToObj;\nexports.getQueryConfig = getQueryConfig;\nexports.getQueryConfigs = getQueryConfigs;\nexports.orderedFromSnap = orderedFromSnap;\nexports.dataByIdSnapshot = dataByIdSnapshot;\nexports.getPopulateChild = getPopulateChild;\nexports.populateList = populateList;\nexports.promisesForPopulate = promisesForPopulate;\nexports.dispatchListenerResponse = dispatchListenerResponse;\nexports.getPopulateActions = getPopulateActions;\nexports.snapshotCache = void 0;\n\nvar _cloneDeep2 = _interopRequireDefault(require(\"lodash/cloneDeep\"));\n\nvar _set2 = _interopRequireDefault(require(\"lodash/set\"));\n\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _map2 = _interopRequireDefault(require(\"lodash/map\"));\n\nvar _has2 = _interopRequireDefault(require(\"lodash/has\"));\n\nvar _forEach2 = _interopRequireDefault(require(\"lodash/forEach\"));\n\nvar _trim2 = _interopRequireDefault(require(\"lodash/trim\"));\n\nvar _isEmpty2 = _interopRequireDefault(require(\"lodash/isEmpty\"));\n\nvar _isNumber2 = _interopRequireDefault(require(\"lodash/isNumber\"));\n\nvar _isObject2 = _interopRequireDefault(require(\"lodash/isObject\"));\n\nvar _constants = require(\"../constants\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toArray(arr) { return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nvar snapshotCache = new WeakMap();\nexports.snapshotCache = snapshotCache;\n\nfunction getSnapshotByObject(obj) {\n  return snapshotCache.get(obj);\n}\n\nfunction addWhereToRef(ref, where) {\n  if (!Array.isArray(where)) {\n    throw new Error('where parameter must be an array.');\n  }\n\n  if (Array.isArray(where[0])) {\n    return where.reduce(function (acc, whereArgs) {\n      return addWhereToRef(acc, whereArgs);\n    }, ref);\n  }\n\n  return ref.where.apply(ref, _toConsumableArray(where));\n}\n\nfunction addOrderByToRef(ref, orderBy) {\n  if (!Array.isArray(orderBy) && !(typeof orderBy === 'string' || orderBy instanceof String)) {\n    throw new Error('orderBy parameter must be an array or string.');\n  }\n\n  if (typeof orderBy === 'string' || orderBy instanceof String) {\n    return ref.orderBy(orderBy);\n  }\n\n  if (typeof orderBy[0] === 'string' || orderBy[0] instanceof String) {\n    return ref.orderBy.apply(ref, _toConsumableArray(orderBy));\n  }\n\n  return orderBy.reduce(function (acc, orderByArgs) {\n    return addOrderByToRef(acc, orderByArgs);\n  }, ref);\n}\n\nfunction arrayify(cursor) {\n  return [].concat(cursor);\n}\n\nfunction handleSubcollections(ref, subcollectionList) {\n  if (Array.isArray(subcollectionList)) {\n    subcollectionList.forEach(function (subcollection) {\n      if (subcollection.collection) {\n        if (typeof ref.collection !== 'function') {\n          throw new Error(\"Collection can only be run on a document. Check that query config for subcollection: \\\"\".concat(subcollection.collection, \"\\\" contains a doc parameter.\"));\n        }\n\n        ref = ref.collection(subcollection.collection);\n      }\n\n      if (subcollection.doc) ref = ref.doc(subcollection.doc);\n      if (subcollection.where) ref = addWhereToRef(ref, subcollection.where);\n\n      if (subcollection.orderBy) {\n        ref = addOrderByToRef(ref, subcollection.orderBy);\n      }\n\n      if (subcollection.limit) ref = ref.limit(subcollection.limit);\n\n      if (subcollection.startAt) {\n        var _ref;\n\n        ref = (_ref = ref).startAt.apply(_ref, _toConsumableArray(arrayify(subcollection.startAt)));\n      }\n\n      if (subcollection.startAfter) {\n        var _ref2;\n\n        ref = (_ref2 = ref).startAfter.apply(_ref2, _toConsumableArray(arrayify(subcollection.startAfter)));\n      }\n\n      if (subcollection.endAt) {\n        var _ref3;\n\n        ref = (_ref3 = ref).endAt.apply(_ref3, _toConsumableArray(arrayify(subcollection.endAt)));\n      }\n\n      if (subcollection.endBefore) {\n        var _ref4;\n\n        ref = (_ref4 = ref).endBefore.apply(_ref4, _toConsumableArray(arrayify(subcollection.endBefore)));\n      }\n\n      ref = handleSubcollections(ref, subcollection.subcollections);\n    });\n  }\n\n  return ref;\n}\n\nfunction firestoreRef(firebase, meta) {\n  var _ref5, _ref6, _ref7, _ref8;\n\n  if (!firebase.firestore) {\n    throw new Error('Firestore must be required and initalized.');\n  }\n\n  var collection = meta.collection,\n      collectionGroup = meta.collectionGroup,\n      doc = meta.doc,\n      subcollections = meta.subcollections,\n      where = meta.where,\n      orderBy = meta.orderBy,\n      limit = meta.limit,\n      startAt = meta.startAt,\n      startAfter = meta.startAfter,\n      endAt = meta.endAt,\n      endBefore = meta.endBefore;\n  var ref = firebase.firestore();\n\n  if (collection && collectionGroup) {\n    throw new Error('Reference cannot contain both Collection and CollectionGroup.');\n  }\n\n  if (collection) ref = ref.collection(collection);\n  if (collectionGroup) ref = ref.collectionGroup(collectionGroup);\n  if (doc) ref = ref.doc(doc);\n  ref = handleSubcollections(ref, subcollections);\n  if (where) ref = addWhereToRef(ref, where);\n  if (orderBy) ref = addOrderByToRef(ref, orderBy);\n  if (limit) ref = ref.limit(limit);\n  if (startAt) ref = (_ref5 = ref).startAt.apply(_ref5, _toConsumableArray(arrayify(startAt)));\n  if (startAfter) ref = (_ref6 = ref).startAfter.apply(_ref6, _toConsumableArray(arrayify(startAfter)));\n  if (endAt) ref = (_ref7 = ref).endAt.apply(_ref7, _toConsumableArray(arrayify(endAt)));\n  if (endBefore) ref = (_ref8 = ref).endBefore.apply(_ref8, _toConsumableArray(arrayify(endBefore)));\n  return ref;\n}\n\nfunction arrayToStr(key, value) {\n  if (typeof value === 'string' || value instanceof String || (0, _isNumber2.default)(value)) {\n    return \"\".concat(key, \"=\").concat(value);\n  }\n\n  if (typeof value[0] === 'string' || value[0] instanceof String) {\n    return \"\".concat(key, \"=\").concat(value.join(':'));\n  }\n\n  if (value && typeof value.toString === 'function') {\n    return \"\".concat(key, \"=\").concat(value.toString());\n  }\n\n  return value.map(function (val) {\n    return arrayToStr(key, val);\n  });\n}\n\nfunction pickQueryParams(obj) {\n  return ['where', 'orderBy', 'limit', 'startAfter', 'startAt', 'endAt', 'endBefore'].reduce(function (acc, key) {\n    return obj[key] ? _objectSpread({}, acc, _defineProperty({}, key, obj[key])) : acc;\n  }, {});\n}\n\nfunction serialize(queryParams) {\n  return Object.keys(queryParams).filter(function (key) {\n    return queryParams[key] !== undefined;\n  }).map(function (key) {\n    return arrayToStr(key, queryParams[key]);\n  }).join('&');\n}\n\nfunction getQueryName(meta) {\n  if (typeof meta === 'string' || meta instanceof String) {\n    return meta;\n  }\n\n  var collection = meta.collection,\n      collectionGroup = meta.collectionGroup,\n      doc = meta.doc,\n      subcollections = meta.subcollections,\n      storeAs = meta.storeAs,\n      remainingMeta = _objectWithoutProperties(meta, [\"collection\", \"collectionGroup\", \"doc\", \"subcollections\", \"storeAs\"]);\n\n  if (!collection && !collectionGroup) {\n    throw new Error('Collection or Collection Group is required to build query name');\n  }\n\n  if (storeAs) {\n    return storeAs;\n  }\n\n  var basePath = collection || collectionGroup;\n\n  if (doc) {\n    basePath = basePath.concat(\"/\".concat(doc));\n  }\n\n  if (collection && subcollections) {\n    console.error('Queries with subcollections must use \"storeAs\" to prevent invalid store updates. This closley matches the upcoming major release (v1), which stores subcollections at the top level by default.');\n    var mappedCollections = subcollections.map(function (subcollection) {\n      return getQueryName(subcollection);\n    });\n    basePath = \"\".concat(basePath, \"/\").concat(mappedCollections.join('/'));\n  }\n\n  var queryParams = pickQueryParams(remainingMeta);\n\n  if (!(0, _isEmpty2.default)(queryParams)) {\n    if (queryParams.where && !Array.isArray(queryParams.where)) {\n      throw new Error('where parameter must be an array.');\n    }\n\n    basePath = basePath.concat('?', serialize(queryParams));\n  }\n\n  return basePath;\n}\n\nfunction getBaseQueryName(meta) {\n  if (typeof meta === 'string' || meta instanceof String) {\n    return meta;\n  }\n\n  var collection = meta.collection,\n      collectionGroup = meta.collectionGroup,\n      subcollections = meta.subcollections,\n      remainingMeta = _objectWithoutProperties(meta, [\"collection\", \"collectionGroup\", \"subcollections\"]);\n\n  if (!collection && !collectionGroup) {\n    throw new Error('Collection or Collection Group is required to build query name');\n  }\n\n  var basePath = collection || collectionGroup;\n\n  if (collection && subcollections) {\n    var mappedCollections = subcollections.map(function (subcollection) {\n      return getQueryName(subcollection);\n    });\n    basePath = \"\".concat(basePath, \"/\").concat(mappedCollections.join('/'));\n  }\n\n  var queryParams = pickQueryParams(remainingMeta);\n\n  if (!(0, _isEmpty2.default)(queryParams)) {\n    if (queryParams.where && !Array.isArray(queryParams.where)) {\n      throw new Error('where parameter must be an array.');\n    }\n\n    basePath = basePath.concat('?', serialize(queryParams));\n  }\n\n  return basePath;\n}\n\nfunction confirmMetaAndConfig(firebase, meta) {\n  if (!meta) {\n    throw new Error('Meta data is required to attach listener.');\n  }\n\n  if (!firebase || !firebase._ || !firebase._.listeners) {\n    throw new Error('Internal Firebase object required to attach listener. Confirm that reduxFirestore enhancer was added when you were creating your store');\n  }\n}\n\nfunction listenerExists(firebase, meta) {\n  confirmMetaAndConfig(firebase, meta);\n  var name = getQueryName(meta);\n  return !!firebase._.listeners[name];\n}\n\nfunction attachListener(firebase, dispatch, meta, unsubscribe) {\n  confirmMetaAndConfig(firebase, meta);\n  var name = getQueryName(meta);\n\n  if (!firebase._.listeners[name]) {\n    firebase._.listeners[name] = unsubscribe;\n  }\n\n  dispatch({\n    type: _constants.actionTypes.SET_LISTENER,\n    meta: meta,\n    payload: {\n      name: name\n    }\n  });\n  return firebase._.listeners;\n}\n\nfunction detachListener(firebase, dispatch, meta) {\n  var name = getQueryName(meta);\n\n  if (firebase._.listeners[name]) {\n    firebase._.listeners[name]();\n\n    delete firebase._.listeners[name];\n  }\n\n  dispatch({\n    type: _constants.actionTypes.UNSET_LISTENER,\n    meta: meta,\n    payload: {\n      name: name\n    }\n  });\n}\n\nfunction queryStrToObj(queryPathStr, parsedPath) {\n  var pathArr = parsedPath || (0, _trim2.default)(queryPathStr, ['/']).split('/');\n\n  var _pathArr = _toArray(pathArr),\n      collection = _pathArr[0],\n      doc = _pathArr[1],\n      subcollections = _pathArr.slice(2);\n\n  var queryObj = {};\n  if (collection) queryObj.collection = collection;\n  if (doc) queryObj.doc = doc;\n\n  if (subcollections.length) {\n    queryObj.subcollections = [queryStrToObj('', subcollections)];\n  }\n\n  return queryObj;\n}\n\nfunction getQueryConfig(query) {\n  if (typeof query === 'string' || query instanceof String) {\n    return queryStrToObj(query);\n  }\n\n  if ((0, _isObject2.default)(query)) {\n    if (!query.collection && !query.collectionGroup && !query.doc) {\n      throw new Error('Collection, Collection Group and/or Doc are required parameters within query definition object.');\n    }\n\n    return query;\n  }\n\n  throw new Error('Invalid Path Definition: Only Strings and Objects are accepted.');\n}\n\nfunction getQueryConfigs(queries) {\n  if (Array.isArray(queries)) {\n    return queries.map(getQueryConfig);\n  }\n\n  if (typeof queries === 'string' || queries instanceof String) {\n    return queryStrToObj(queries);\n  }\n\n  if ((0, _isObject2.default)(queries)) {\n    return [getQueryConfig(queries)];\n  }\n\n  throw new Error('Querie(s) must be an Array or a string.');\n}\n\nfunction orderedFromSnap(snap) {\n  var ordered = [];\n\n  if (snap.data && snap.exists) {\n    var obj = (0, _isObject2.default)(snap.data()) ? _objectSpread({\n      id: snap.id\n    }, snap.data() || snap.data) : {\n      id: snap.id,\n      data: snap.data()\n    };\n    snapshotCache.set(obj, snap);\n    ordered.push(obj);\n  } else if (snap.forEach) {\n    snap.forEach(function (doc) {\n      var obj = (0, _isObject2.default)(doc.data()) ? _objectSpread({\n        id: doc.id\n      }, doc.data() || doc.data) : {\n        id: doc.id,\n        data: doc.data()\n      };\n      snapshotCache.set(obj, doc);\n      ordered.push(obj);\n    });\n  }\n\n  snapshotCache.set(ordered, snap);\n  return ordered;\n}\n\nfunction dataByIdSnapshot(snap) {\n  var data = {};\n\n  if (snap.data) {\n    var snapData = snap.exists ? snap.data() : null;\n\n    if (snapData) {\n      snapshotCache.set(snapData, snap);\n    }\n\n    data[snap.id] = snapData;\n  } else if (snap.forEach) {\n    snap.forEach(function (doc) {\n      var snapData = doc.data() || doc;\n      snapshotCache.set(snapData, doc);\n      data[doc.id] = snapData;\n    });\n  }\n\n  if (!!data && Object.keys(data).length) {\n    snapshotCache.set(data, snap);\n    return data;\n  }\n\n  return null;\n}\n\nfunction getPopulateChild(firebase, populate, id) {\n  return firestoreRef(firebase, {\n    collection: populate.root,\n    doc: id\n  }).get().then(function (snap) {\n    return _objectSpread({\n      id: id\n    }, snap.data());\n  });\n}\n\nfunction populateList(firebase, originalObj, p, results) {\n  if (!results[p.root]) {\n    (0, _set2.default)(results, p.root, {});\n  }\n\n  return Promise.all((0, _map2.default)(originalObj, function (id, childKey) {\n    var populateKey = id === true || p.populateByKey ? childKey : id;\n    return getPopulateChild(firebase, p, populateKey).then(function (pc) {\n      if (pc) {\n        return (0, _set2.default)(results, \"\".concat(p.root, \".\").concat(populateKey), pc);\n      }\n\n      return results;\n    });\n  }));\n}\n\nfunction getPopulateObj(str) {\n  if (typeof str === 'string' || str instanceof String) {\n    return str;\n  }\n\n  var strArray = str.split(':');\n  return {\n    child: strArray[0],\n    root: strArray[1]\n  };\n}\n\nfunction getPopulateObjs(arr) {\n  if (!Array.isArray(arr)) {\n    return arr;\n  }\n\n  return arr.map(function (o) {\n    return (0, _isObject2.default)(o) ? o : getPopulateObj(o);\n  });\n}\n\nfunction promisesForPopulate(firebase, dataKey, originalData, populatesIn) {\n  var promisesArray = [];\n  var results = {};\n  var populatesForData = getPopulateObjs(typeof populatesIn === 'function' ? populatesIn(dataKey, originalData) : populatesIn);\n  var dataHasPopulateChilds = populatesForData.some(function (populate) {\n    return (0, _has2.default)(originalData, populate.child);\n  });\n\n  if (dataHasPopulateChilds) {\n    populatesForData.forEach(function (p) {\n      var childDataVal = (0, _get2.default)(originalData, p.child);\n\n      if (typeof childDataVal === 'string' || childDataVal instanceof String) {\n        return promisesArray.push(getPopulateChild(firebase, p, childDataVal).then(function (v) {\n          if (v) {\n            (0, _set2.default)(results, \"\".concat(p.storeAs ? p.storeAs : p.root, \".\").concat(childDataVal), v);\n          }\n        }));\n      }\n\n      return promisesArray.push(populateList(firebase, childDataVal, p, results));\n    });\n  } else {\n    (0, _forEach2.default)(originalData, function (d, key) {\n      var populatesForDataItem = getPopulateObjs(typeof populatesIn === 'function' ? populatesIn(key, d) : populatesIn);\n      (0, _forEach2.default)(populatesForDataItem, function (p) {\n        var idOrList = (0, _get2.default)(d, p.child);\n\n        if (!idOrList) {\n          return;\n        }\n\n        if (typeof idOrList === 'string' || idOrList instanceof String) {\n          return promisesArray.push(getPopulateChild(firebase, p, idOrList).then(function (v) {\n            if (v) {\n              (0, _set2.default)(results, \"\".concat(p.storeAs ? p.storeAs : p.root, \".\").concat(idOrList), v);\n            }\n\n            return results;\n          }));\n        }\n\n        if (Array.isArray(idOrList) || (0, _isObject2.default)(idOrList)) {\n          return promisesArray.push(populateList(firebase, idOrList, p, results));\n        }\n      });\n    });\n  }\n\n  return Promise.all(promisesArray).then(function () {\n    return results;\n  });\n}\n\nvar changeTypeToEventType = {\n  added: _constants.actionTypes.DOCUMENT_ADDED,\n  removed: _constants.actionTypes.DOCUMENT_REMOVED,\n  modified: _constants.actionTypes.DOCUMENT_MODIFIED\n};\n\nfunction docChangeEvent(change) {\n  var originalMeta = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var meta = _objectSpread({}, (0, _cloneDeep2.default)(originalMeta), {\n    path: change.doc.ref.path\n  });\n\n  if (originalMeta.subcollections && !originalMeta.storeAs) {\n    meta.subcollections[0] = _objectSpread({}, meta.subcollections[0], {\n      doc: change.doc.id\n    });\n  } else {\n    meta.doc = change.doc.id;\n  }\n\n  return {\n    type: changeTypeToEventType[change.type] || _constants.actionTypes.DOCUMENT_MODIFIED,\n    meta: meta,\n    payload: {\n      data: change.doc.data(),\n      ordered: {\n        oldIndex: change.oldIndex,\n        newIndex: change.newIndex\n      }\n    }\n  };\n}\n\nfunction dispatchListenerResponse(_ref9) {\n  var dispatch = _ref9.dispatch,\n      docData = _ref9.docData,\n      meta = _ref9.meta,\n      firebase = _ref9.firebase;\n\n  var _ref10 = firebase._.config || {},\n      mergeOrdered = _ref10.mergeOrdered,\n      mergeOrderedDocUpdates = _ref10.mergeOrderedDocUpdates,\n      mergeOrderedCollectionUpdates = _ref10.mergeOrderedCollectionUpdates;\n\n  var docChanges = typeof docData.docChanges === 'function' ? docData.docChanges() : docData.docChanges;\n\n  if (docChanges && docChanges.length < docData.size) {\n    docChanges.forEach(function (change) {\n      dispatch(docChangeEvent(change, meta));\n    });\n  } else {\n    dispatch({\n      type: _constants.actionTypes.LISTENER_RESPONSE,\n      meta: meta,\n      payload: {\n        data: dataByIdSnapshot(docData),\n        ordered: orderedFromSnap(docData)\n      },\n      merge: {\n        docs: mergeOrdered && mergeOrderedDocUpdates,\n        collections: mergeOrdered && mergeOrderedCollectionUpdates\n      }\n    });\n  }\n}\n\nfunction getPopulateActions(_ref11) {\n  var firebase = _ref11.firebase,\n      docData = _ref11.docData,\n      meta = _ref11.meta;\n  return promisesForPopulate(firebase, docData.id, dataByIdSnapshot(docData), meta.populates).then(function (populateResults) {\n    return Object.keys(populateResults).map(function (resultKey) {\n      return {\n        meta: {\n          collection: resultKey\n        },\n        payload: {\n          data: populateResults[resultKey]\n        },\n        requesting: false,\n        requested: true\n      };\n    });\n  }).catch(function (populateErr) {\n    console.error('Error with populate:', populateErr, meta);\n    return Promise.reject(populateErr);\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}